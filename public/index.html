<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-powered running form analysis using MediaPipe pose detection. Analyze your running technique for better performance and injury prevention.">
    <meta name="keywords" content="running, form analysis, pose detection, MediaPipe, AI, sports technology">
    <meta name="author" content="RunForm.AI">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title>RunForm.AI - AI Personal Running Form Coach</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèÉ‚Äç‚ôÇÔ∏è</text></svg>">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- MediaPipe Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>
    
    <!-- Demo Configuration -->
    <script src="demo-config.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header Section -->
        <header class="hero-section">
            <div class="hero-content">
                <div class="logo">
                    <span class="logo-icon">üèÉ‚Äç‚ôÇÔ∏è</span>
                    <h1 class="logo-text">RunForm.AI</h1>
                </div>
                <p class="hero-subtitle">AI Personal Running Form Coach powered by Advanced Analytics</p>
                <div class="tips-banner">
                    <span class="tip-icon">üí°</span>
                    <p id="rotatingTip">Record from the side view for best results</p>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-container">
            <div class="content-wrapper">
                
                <!-- Step 1: Input Selection -->
                <section class="step-section" id="step1">
                    <div class="step-header">
                        <span class="step-number">1</span>
                        <h2>Choose Input Method</h2>
                    </div>
                    <div class="input-options">
                        <button id="webcamBtn" class="option-card webcam-option" aria-label="Start camera recording">
                            <div class="option-icon">üìπ</div>
                            <h3>Record with Camera</h3>
                            <p>Use your device camera to record running form</p>
                        </button>
                        <button id="uploadBtn" class="option-card upload-option" aria-label="Upload video file">
                            <div class="option-icon">üìÅ</div>
                            <h3>Upload Video</h3>
                            <p>Analyze existing video files (MP4, MOV, WebM)</p>
                        </button>
                        <input type="file" id="videoUpload" accept="video/*" style="display: none;" aria-label="Video file input">
                    </div>

                    <!-- Camera Section -->
                    <div id="cameraSection" class="camera-container" style="display: none;">
                        <div class="video-preview">
                            <video id="webcam" autoplay muted playsinline aria-label="Camera preview"></video>
                            <div class="camera-overlay">
                                <div class="recording-indicator" id="recordingIndicator" style="display: none;">
                                    <span class="pulse-dot"></span>
                                    <span>Recording</span>
                                </div>
                            </div>
                        </div>
                        <div class="camera-controls">
                            <button id="startRecording" class="control-button primary">
                                <span class="btn-icon">‚óè</span>
                                Start Recording
                            </button>
                            <button id="stopRecording" class="control-button danger" style="display: none;">
                                <span class="btn-icon">‚ñ†</span>
                                Stop Recording
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Step 2: Analysis Section -->
                <section class="step-section" id="step2" style="display: none;">
                    <div class="step-header">
                        <span class="step-number">2</span>
                        <h2>Analysis Workspace</h2>
                    </div>
                    
                    <div class="analysis-workspace">
                        <div class="video-analysis-container">
                            <div class="analysis-canvas">
                                <canvas id="outputCanvas" width="640" height="480"></canvas>
                                <div class="canvas-overlay">
                                    <div class="frame-info" id="frameInfo">Frame: 0</div>
                                    <div class="analysis-indicators">
                                        <div class="indicator" id="poseIndicator">
                                            <span class="indicator-dot"></span>
                                            <span>Pose Detection</span>
                                        </div>
                                        <div class="indicator" id="motionIndicator">
                                            <span class="indicator-dot"></span>
                                            <span>Motion Analysis</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Interactive Controls -->
                                <div class="video-controls" id="videoControls" style="display: none;">
                                    <button class="control-btn" id="stepBackBtn" title="Previous Frame">‚èÆÔ∏è</button>
                                    <button class="control-btn" id="playPauseBtn" title="Play/Pause">‚èØÔ∏è</button>
                                    <button class="control-btn" id="stepForwardBtn" title="Next Frame">‚è≠Ô∏è</button>
                                    <button class="control-btn" id="slowMotionBtn" title="Slow Motion">üêå</button>
                                </div>
                            </div>
                            
                            <!-- Video Preview -->
                            <div class="video-preview-section" id="videoPreviewSection" style="display: none;">
                                <div class="preview-header">
                                    <h4>üìπ Video Preview</h4>
                                    <div class="video-info" id="videoInfo">
                                        <span class="info-item">Duration: <span id="videoDuration">0s</span></span>
                                        <span class="info-item">Quality: <span id="videoQuality">Unknown</span></span>
                                    </div>
                                </div>
                                <video id="inputVideo" controls aria-label="Uploaded video"></video>
                            </div>
                        </div>

                        <!-- Analysis Controls -->
                        <div class="analysis-controls">
                            <button id="analyzeBtn" class="action-button primary" disabled>
                                <span class="btn-icon">üîç</span>
                                <span class="btn-text">
                                    <strong>Analyze Running Form</strong>
                                    <small>Start AI coaching analysis</small>
                                </span>
                            </button>
                            <button id="resetBtn" class="action-button secondary">
                                <span class="btn-icon">üîÑ</span>
                                <span class="btn-text">
                                    <strong>Reset</strong>
                                    <small>Start over</small>
                                </span>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Step 3: Results Section -->
                <section class="step-section" id="step3" style="display: none;">
                    <div class="step-header">
                        <span class="step-number">3</span>
                        <h2>AI Coaching Analysis</h2>
                    </div>
                    
                    <div id="feedbackSection" class="results-container">
                        <!-- Metrics Overview -->
                        <div id="metricsOverview" class="metrics-overview">
                            <!-- Will be populated with metrics -->
                        </div>

                        <!-- Best/Worst Frame Snapshots -->
                        <div id="frameSnapshots" class="frame-snapshots-section">
                            <h3>üì∏ Key Moments Analysis</h3>
                            <div class="snapshots-grid" id="snapshotsGrid">
                                <!-- Will be populated with frame snapshots -->
                            </div>
                        </div>

                        <!-- Interactive Charts -->
                        <div id="chartsSection" class="charts-section">
                            <h3>üìà Performance Analytics</h3>
                            <div class="charts-grid">
                                <div class="chart-container">
                                    <canvas id="kneeAngleChart"></canvas>
                                </div>
                                <div class="chart-container">
                                    <canvas id="torsoAngleChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Personalized Coaching -->
                        <div id="coachingSection" class="coaching-section">
                            <h3>üéØ Personalized Coaching</h3>
                            <div id="coachingContent" class="coaching-content">
                                <!-- Will be populated with coaching insights -->
                            </div>
                        </div>

                        <!-- Data Quality Report -->
                        <div id="dataQualitySection" class="data-quality-section">
                            <h3>üìä Data Quality Report</h3>
                            <div id="dataQualityContent" class="data-quality-content">
                                <!-- Will be populated with quality metrics -->
                            </div>
                        </div>

                        <!-- Detailed Analysis -->
                        <div id="feedbackContent" class="feedback-grid">
                            <!-- Results will be populated here -->
                        </div>
                        
                        <!-- Export & Share Controls -->
                        <div class="export-controls">
                            <button id="exportPdfBtn" class="action-button success">
                                <span class="btn-icon">üìÑ</span>
                                <span class="btn-text">
                                    <strong>Export PDF Report</strong>
                                    <small>Download comprehensive analysis</small>
                                </span>
                            </button>
                            <button id="exportImageBtn" class="action-button secondary">
                                <span class="btn-icon">üñºÔ∏è</span>
                                <span class="btn-text">
                                    <strong>Export as Image</strong>
                                    <small>Save visual summary</small>
                                </span>
                            </button>
                            <button id="shareBtn" class="action-button secondary">
                                <span class="btn-icon">üì§</span>
                                <span class="btn-text">
                                    <strong>Share Analysis</strong>
                                    <small>Generate share link</small>
                                </span>
                            </button>
                        </div>
                    </div>
                </section>

            </div>
        </main>

        <!-- Progress Overlay -->
        <div class="progress-overlay" id="progressSection" style="display: none;">
            <div class="progress-content">
                <div class="progress-header">
                    <h3>üîç AI Coaching Analysis</h3>
                    <p id="progressText">Initializing advanced pose detection...</p>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="progress-stats">
                    <div class="stat">
                        <span class="stat-label">Frames Processed</span>
                        <span class="stat-value" id="framesProcessed">0</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Insights Generated</span>
                        <span class="stat-value" id="issuesDetected">0</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Analysis Quality</span>
                        <span class="stat-value" id="currentQuality">Building...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Indicator -->
        <div class="status-indicator" id="analysisStatus" style="display: none;">
            <div class="status-content">
                <span class="status-icon">üîÑ</span>
                <span class="status-text">Ready</span>
            </div>
        </div>

        <!-- Loading Overlays -->
        <div id="loadingOverlay" class="loading-overlay" style="display: none;">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <h3>AI Coaching Analysis</h3>
                <p>Processing your running form with advanced AI...</p>
            </div>
        </div>

        <div id="mediapipeLoading" class="loading-overlay" style="display: flex;">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <h3>üèÉ‚Äç‚ôÇÔ∏è Initializing RunForm.AI</h3>
                <p>Loading AI coaching models and pose detection systems...</p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <div class="privacy-notice">
                    <span class="privacy-icon">üîí</span>
                    <span>Privacy-First: All analysis happens locally. No data is sent to servers.</span>
                </div>
                <div class="footer-links">
                    <span>Built with ‚ù§Ô∏è using MediaPipe & Chart.js</span>
                    <a href="https://github.com/runform-ai" target="_blank" rel="noopener">GitHub</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Main Application Script -->
    <script src="app.js"></script>
    <script src="phase2-features.js"></script>
    <script src="app-main.js"></script>
</body>
</html> 